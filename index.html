<h1>Pride Flags as colour palettes</h1>

<label>
	<span>Background Colour:</span>
	<input value="#f2f2f3" type="color" id="background-color"></input>
</label>

<section>
	<h2>Rainbow</h2>
	<!--
		hsl(0, 97%, 45%)
		hsl(33, 100%, 50%)
		hsl(56, 100%, 50%)
		hsl(138, 100%, 25%)
		hsl(222, 100%, 50%)
		hsl(292, 91%, 27%)
	-->
	<section class="hint box">
		Yes this looks horrendous.
		No you probably shouldn't use this as the actual colour palette for your website.
		Yes it is inevitable that it will happen anyway.
	</section>
	<div class="colors" style="--hue: 0deg; --saturation: 100%;">
		<button style="--lightness: 05%"></button>
		<button style="--lightness: 15%"></button>
		<button style="--lightness: 30%"></button>
		<button style="--lightness: 40%"></button>
		<button style="--lightness: 50%"></button>
		<button style="--lightness: 60%"></button>
		<button style="--lightness: 70%"></button>
		<button style="--lightness: 80%"></button>
		<button style="--lightness: 95%"></button>
	</div>
	<div class="colors" style="--hue: 33deg; --saturation: 100%;">
		<button style="--lightness: 05%"></button>
		<button style="--lightness: 15%"></button>
		<button style="--lightness: 30%"></button>
		<button style="--lightness: 40%"></button>
		<button style="--lightness: 50%"></button>
		<button style="--lightness: 60%"></button>
		<button style="--lightness: 70%"></button>
		<button style="--lightness: 80%"></button>
		<button style="--lightness: 95%"></button>
	</div>
	<div class="colors" style="--hue: 56deg; --saturation: 100%;">
		<button style="--lightness: 05%"></button>
		<button style="--lightness: 15%"></button>
		<button style="--lightness: 30%"></button>
		<button style="--lightness: 40%"></button>
		<button style="--lightness: 50%"></button>
		<button style="--lightness: 60%"></button>
		<button style="--lightness: 70%"></button>
		<button style="--lightness: 80%"></button>
		<button style="--lightness: 95%"></button>
	</div>
	<div class="colors" style="--hue: 138deg; --saturation: 100%;">
		<button style="--lightness: 05%"></button>
		<button style="--lightness: 15%"></button>
		<button style="--lightness: 30%"></button>
		<button style="--lightness: 40%"></button>
		<button style="--lightness: 50%"></button>
		<button style="--lightness: 60%"></button>
		<button style="--lightness: 70%"></button>
		<button style="--lightness: 80%"></button>
		<button style="--lightness: 95%"></button>
	</div>
	<div class="colors" style="--hue: 222deg; --saturation: 100%;">
		<button style="--lightness: 05%"></button>
		<button style="--lightness: 15%"></button>
		<button style="--lightness: 30%"></button>
		<button style="--lightness: 40%"></button>
		<button style="--lightness: 50%"></button>
		<button style="--lightness: 60%"></button>
		<button style="--lightness: 70%"></button>
		<button style="--lightness: 80%"></button>
		<button style="--lightness: 95%"></button>
	</div>
	<div class="colors" style="--hue: 292deg; --saturation: 100%;">
		<button style="--lightness: 05%"></button>
		<button style="--lightness: 15%"></button>
		<button style="--lightness: 30%"></button>
		<button style="--lightness: 40%"></button>
		<button style="--lightness: 50%"></button>
		<button style="--lightness: 60%"></button>
		<button style="--lightness: 70%"></button>
		<button style="--lightness: 80%"></button>
		<button style="--lightness: 95%"></button>
	</div>

	<h2>Transgender</h2>
	<section class="hint box">
		Sicne the colours of the transgender flag are very desaturated, they look a bit weird when presented fully saturated like this.<br>
		The second column from the right gets relatively <em>close</em> to the actual flag colours.
	</section>
	<!--
		hsl(197, 93%, 67%)
	-->
	<div class="colors" style="--hue: 197deg; --saturation: 93%;">
		<button style="--lightness: 05%"></button>
		<button style="--lightness: 15%"></button>
		<button style="--lightness: 30%"></button>
		<button style="--lightness: 40%"></button>
		<button style="--lightness: 50%"></button>
		<button style="--lightness: 60%"></button>
		<button style="--lightness: 70%"></button>
		<button style="--lightness: 80%"></button>
		<button style="--lightness: 95%"></button>
	</div>
	<!--
		hsl(346, 72%, 80%)
	-->
	<div class="colors" style="--hue: 346deg; --saturation: 72%;">
		<button style="--lightness: 05%"></button>
		<button style="--lightness: 15%"></button>
		<button style="--lightness: 30%"></button>
		<button style="--lightness: 40%"></button>
		<button style="--lightness: 50%"></button>
		<button style="--lightness: 60%"></button>
		<button style="--lightness: 70%"></button>
		<button style="--lightness: 80%"></button>
		<button style="--lightness: 95%"></button>
	</div>

	<div class="colors" style="--hue: 210deg; --saturation: 5%;">
		<button style="--lightness: 05%"></button>
		<button style="--lightness: 15%"></button>
		<button style="--lightness: 30%"></button>
		<button style="--lightness: 40%"></button>
		<button style="--lightness: 50%"></button>
		<button style="--lightness: 60%"></button>
		<button style="--lightness: 70%"></button>
		<button style="--lightness: 80%"></button>
		<button style="--lightness: 95%"></button>
	</div>
</section>

<section>
	<h2>Non-Binary</h2>
	<!--
		hsl(52, 100%, 49%)
	-->
	<div class="colors" style="--hue: 52deg; --saturation: 100%;">
		<button style="--lightness: 05%"></button>
		<button style="--lightness: 15%"></button>
		<button style="--lightness: 30%"></button>
		<button style="--lightness: 40%"></button>
		<button style="--lightness: 52%"></button>
		<button style="--lightness: 60%"></button>
		<button style="--lightness: 70%"></button>
		<button style="--lightness: 80%"></button>
		<button style="--lightness: 95%"></button>
	</div>
	<!--
		hsl(285, 52%, 48%)
	-->
	<div class="colors" style="--hue: 285deg; --saturation: 52%;">
		<button style="--lightness: 05%"></button>
		<button style="--lightness: 15%"></button>
		<button style="--lightness: 30%"></button>
		<button style="--lightness: 40%"></button>
		<button style="--lightness: 52%"></button>
		<button style="--lightness: 60%"></button>
		<button style="--lightness: 70%"></button>
		<button style="--lightness: 80%"></button>
		<button style="--lightness: 95%"></button>
	</div>
	<div class="colors" style="--hue: 210deg; --saturation: 5%;">
		<button style="--lightness: 05%"></button>
		<button style="--lightness: 15%"></button>
		<button style="--lightness: 30%"></button>
		<button style="--lightness: 40%"></button>
		<button style="--lightness: 50%"></button>
		<button style="--lightness: 60%"></button>
		<button style="--lightness: 70%"></button>
		<button style="--lightness: 80%"></button>
		<button style="--lightness: 95%"></button>
	</div>
</section>

<!-- ======================================== -->
<!-- ===== STYLES AND APPLICATION LOGIC ===== -->
<!-- ======================================== -->

<style>
	:root {
		font-size: 1em;
		color: hsl(220deg, 8%, 20%);
		font-family: "Open Sans", sans-serif;
	}
	body.dark {
		color: hsl(220deg, 8%, 80%);
	}

	* {
		box-sizing: border-box;
	}

	code {
		font-family: "Hack", monospace;
	}

	body {
		display: flex;
		flex-flow: column nowrap;
		align-items: center;
		background: hsl(200deg, 5%, 95%);
	}
	/* The following only does font size shenanigans! */

	h1, h2 {
		text-align: center;
		font-weight: normal;
		font-family: "Raleway", "Quicksand", serif;
	}

	h1 {
		font-size: 2.4em;
		--border: dotted .08em currentcolor;
		border-bottom: var(--border);
		border-top: var(---border);
		width: calc((3rem + .6rem * 2) * 9);
		text-align: center;
		padding: .2em 0;
	}
	h2 {
		font-size: 2em;
	}

	div.colors {
		--separation2: .6em; /* Halved separation */
		display: flex;
		/* padding: var(--separation2); */
	}

	div.colors button {
		position: relative;
		all: unset;
		margin: var(--separation2);
		cursor: pointer;
		border-radius: 18%;
		overflow: hidden;
		transition: box-shadow 0.3s;
		width: 3em;
		height: 3em;
	} div.colors button::before {
		width: inherit;
		height: inherit;
		content: '';
		border-radius: inherit;
		background: hsl(var(--hue), var(--saturation, 50%), var(--lightness, 50%));
		box-shadow: .1em .1em .8em hsla(calc(var(--hue) + 30deg), calc(100% - var(--lightness) - 10%), calc(var(--lightness) - 40%), .4) inset;
		display: block;
		transition: box-shadow 0.3s;
	}

	div.colors button:hover {
		box-shadow: .4em .4em .6em #0004;
	}
	div.colors button:hover::before {
		box-shadow: none;
	}
	body.dark div.colors button:hover {
		box-shadow: .0em .0em .6em hsla(var(--hue), calc(var(--saturation) + 30%), 80%, 60%);
	}

	/* === Popup notification shenanigans === */

	@keyframes fade {
		0%   { opacity: 0; transform: translate(-50%, -10%)}
		20%  { opacity: 1;}
		50%  { opacity: 1;}
		100% { opacity: 0; transform: translate(-50%, -150%)}
	}

	div.notification {
		top: 0em;
		border: 1px solid currentcolor;
		background: hsla(0deg, 0%, 100%, .8);
		font-size: 1em;
		opacity: 0;
		position: fixed;
		padding: .4em; 1em;
		font-weight: bold;
		text-align: center;
	}

	/* === Info Boxes === */

	.box {
		--radius: .3em;
		width: calc((3rem + .6rem * 2) * 9);
		font-style: italic;
		border-radius: var(--radius);
		background: hsla(200deg, 5%, 92%, 1);
		box-shadow: .0em .1em .2em inset hsl(220deg, 8%, 80%);
		padding: 1em 2em;

		position: relative;
		margin: 2em 0em;
	}

	body.dark .box {
		background: hsla(200deg, 5%, 6%, 1);
		box-shadow: .0em .1em .2em inset #0006;
	}

	.hint, .info { --color: hsl(346deg, 72%, 80%) }
	.todo { --color: hsl(197deg, 93%, 80%) }

	.box::after {
		display: block;
		position: absolute;
		left: 0;
		top: 0;
		height: 100%;
		width: .4em;
		background-color: var(--color, transparent);
		border-radius: var(--radius) 0 0 var(--radius);
		content: '';
	}

	.box.hint::before {
		content: "Hint: ";
		display: inline-block;
		font-weight: bold;
	}

	.box.todo::before {
		content: "Todo: ";
		display: inline-block;
		font-weight: bold;
	}

	/* === Utility === */

	[center] { text-align: center; }
</style>

<script type="module">
	const showMessage = function(message, color, x, y) {
		let box = document.createElement('div');
		box.innerHTML = message;
		box.classList.add('notification');

		if (x) box.style.left = x+"px";
		if (y) box.style.top = y+"px";

		document.querySelector("body").appendChild(box);

		box.style.setProperty('animation', 'fade 1s');
		box.style.setProperty('animation-fill-mode', 'forwards');
		box.style.setProperty('color', color);

		box.addEventListener("animationend", ({box: target}) => box.parentElement.removeChild(box))
	}

	document.querySelectorAll('div.colors button').forEach(button => {
		button.addEventListener('click', event => {
			const prop = name => getComputedStyle(button)
				.getPropertyValue(name)
				.replace(/^ *| *$/g, "")
			const colour = `hsl(${prop("--hue")}, ${prop("--saturation")}, ${prop("--lightness")})`
			navigator.clipboard.writeText(colour).then(() => {
				const box = button.getBoundingClientRect()
				showMessage(`Copied to Clipboard:<br>${colour}`, colour, box.x+box.width/2, box.y+box.height/2);
			});
		});
	});

	const register = (type, name, initial=undefined) => CSS.registerProperty({
		name: `--${name}`,
		syntax: `<${type}>`,
		inherits: true,
		initialValue: initial,
	})

	register("angle", "hue", "0deg")
	register("percentage", "saturation", "100%")
	register("percentage", "lightness", "50%")

	const backgroundColourButton = document.getElementById("background-color")
	backgroundColourButton.addEventListener("input", event => {
		const rgb = backgroundColourButton.value
		document.body.style.background = rgb
		const channels = rgb
			.match(/[0-9a-f][0-9a-f]/g)
			.map(hex => parseInt(hex, 16))
			.map(num => num / 255)
		const luminosity = channels.reduce((a,b)=>a+b) / 3
		if (luminosity < 0.4) {
			document.body.classList.add("dark")
		} else {
			document.body.classList.remove("dark")
		}
	})
</script>
